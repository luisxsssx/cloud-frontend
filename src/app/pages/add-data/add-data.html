<div class="relative">
    <button (click)="showAdd()" class="flex items-center gap-2 px-3 py-1.5
               bg-white border border-gray-300 rounded-lg shadow-sm
               hover:bg-[#F1F5F3] transition
               text-gray-700 text-sm cursor-pointer">
        <svg class="w-5 h-5 text-[#3A5A40]" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
        </svg>
        New
    </button>

    @if (show) {
    <div class="absolute left-0 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-xl z-50
               py-2 animate-fade-slide">
        <button (click)="ShowAddFolder()" class="w-full text-left px-4 py-2 text-sm text-gray-700
                   hover:bg-[#F1F5F3] hover:text-[#3A5A40]
                   flex items-center gap-2 cursor-pointer">
            üìÅ Create folder
        </button>
        <button (click)="showUpFile()" class="w-full text-left px-4 py-2 text-sm text-gray-700
                   hover:bg-[#F1F5F3] hover:text-[#3A5A40]
                   flex items-center gap-2 cursor-pointer">
            Up file
        </button>
    </div>
    }
</div>

@if (addFolder) {
<div class="fixed top-0 left-0 w-screen h-screen flex items-center justify-center
           bg-black/40 z-[9999] pointer-events-auto" (click)="addFolder = false">

    <form #form="ngForm" class="bg-white p-6 rounded-xl shadow-xl" (click)="$event.stopPropagation()"
        (ngSubmit)="createFolder()">

        <input [(ngModel)]="add.folder_name" type="text" name="folder_name" placeholder="Folder Name" required class="border border-gray-300 p-2 rounded-md w-full
                   focus:outline-none focus:ring-2 focus:ring-[#3A5A40]" />

        <div class="flex justify-end gap-2 mt-4">
            <button type="submit" class="bg-[#3A5A40] hover:bg-[#2F4A34]
                       text-white p-2 ml-2 rounded-md cursor-pointer transition">
                Create
            </button>

            <button class="px-4 py-2 bg-gray-300 hover:bg-gray-400
                       rounded cursor-pointer transition" (click)="addFolder = false">
                Cancel
            </button>
        </div>
    </form>
</div>
}

@if (upFile) {
<div class="fixed top-0 left-0 w-screen h-screen flex items-center justify-center
           bg-black/40 z-[9999] pointer-events-auto">

    <form (click)="$event.stopPropagation()" class="bg-white w-[380px] p-6 rounded-2xl shadow-2xl animate-fade">

        <h2 class="text-xl font-semibold mb-4 text-gray-900">
            Upload a file
        </h2>

        <div class="border-2 border-dashed border-gray-300 rounded-xl p-6 text-center
                   cursor-pointer hover:border-[#3A5A40] transition" (click)="fileInput.click()">
            <div class="text-3xl mb-2">‚¨ÜÔ∏è</div>
            <p class="text-gray-600 text-sm">Click to choose a file</p>
            <input type="file" #fileInput hidden (change)="onFileSelected($event)" />
        </div>

        @if (fileSelect) {
        <div class="mt-4 bg-[#F1F5F3] rounded-lg px-3 py-2 text-sm text-gray-700
                   flex items-center justify-between">
            <span>{{ fileSelect.name }}</span>
        </div>
        }

        <div class="mt-6 flex justify-end gap-3">
            <button type="button" (click)="upFile = false" class="px-4 py-2 rounded-lg bg-gray-200
                       hover:bg-gray-300 transition cursor-pointer">
                Cancel
            </button>

            <button type="button" (click)="onUpload()" [disabled]="!fileSelect" class="px-4 py-2 rounded-lg bg-[#3A5A40]
                       hover:bg-[#2F4A34] text-white transition
                       disabled:opacity-50 disabled:cursor-not-allowed">
                Up File
            </button>
        </div>

    </form>
</div>
}